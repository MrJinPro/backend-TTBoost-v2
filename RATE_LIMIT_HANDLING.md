# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ TikTok API

## –ü—Ä–æ–±–ª–µ–º–∞

TikTok Live API (`TikTokLive` –±–∏–±–ª–∏–æ—Ç–µ–∫–∞) –∏–º–µ–µ—Ç —Å—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:
- **–õ–∏–º–∏—Ç**: —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∑–∞ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏
- **–û—à–∏–±–∫–∞**: `SignatureRateLimitError: Too many connections started`
- **–û–∫–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ø—Ä–∏–º–µ—Ä–Ω–æ 1 —á–∞—Å

## –†–µ—à–µ–Ω–∏–µ

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ rate limit

–ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ rate limit —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫—É –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:

```python
try:
    await tiktok_service.start_client(...)
    logger.info(f"‚úÖ TikTok Live –∫–ª–∏–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω –¥–ª—è @{tiktok_username}")
except SignatureRateLimitError as e:
    logger.error(f"‚ùå Rate limit –æ—Ç TikTok API: {e}")
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    await websocket.send_text(json.dumps({
        "type": "error",
        "message": "‚ùå –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π TikTok API",
        "details": "–ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ EulerStream API –¥–ª—è —Å–Ω—è—Ç–∏—è –ª–∏–º–∏—Ç–æ–≤."
    }, ensure_ascii=False))
    # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    await websocket.close(code=status.WS_1008_POLICY_VIOLATION)
    return
```

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- **Snackbar** —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏ (–∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω, 8 —Å–µ–∫—É–Ω–¥)
- **–õ–æ–≥ —Å–æ–±—ã—Ç–∏–π** —Å –º–µ—Ç–∫–æ–π `[error]`
- **–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

### 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ TikTok Username

–ï—Å–ª–∏ username –Ω–µ —É–∫–∞–∑–∞–Ω, —Å–µ—Ä–≤–µ—Ä –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

```python
if not tiktok_username or not tiktok_username.strip():
    await websocket.send_text(json.dumps({
        "type": "error",
        "message": "‚ö†Ô∏è –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å TikTok username",
        "details": "–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–∫–∞–∂–∏—Ç–µ –≤–∞—à TikTok username"
    }, ensure_ascii=False))
    await websocket.close(code=status.WS_1008_POLICY_VIOLATION)
```

## –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å rate limit

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–¥–æ–∂–¥–∞—Ç—å (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
–ü–æ–¥–æ–∂–¥–∏—Ç–µ ~1 —á–∞—Å –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –æ—à–∏–±–∫–∏ rate limit.

### –í–∞—Ä–∏–∞–Ω—Ç 2: EulerStream API Key (–ø–ª–∞—Ç–Ω–æ)
–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://www.eulerstream.com/pricing –¥–ª—è —Å–Ω—è—Ç–∏—è –ª–∏–º–∏—Ç–æ–≤.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –†–µ–∂–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è
–ò–∑–±–µ–≥–∞–π—Ç–µ —á–∞—Å—Ç—ã—Ö –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ TikTok Live.

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend
- `app/routes/ws.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ TikTok API –≤ WebSocket
- `app/services/tiktok_service.py` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ TikTok Live

### Mobile
- `lib/services/ws_service.dart` - –ø—Ä–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
- `lib/screens/home_screen.dart` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤

### –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
INFO: ÔøΩ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ TikTok Live: @username
INFO: ‚úÖ TikTok Live –∫–ª–∏–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω –¥–ª—è @username
```

### Rate Limit
```
ERROR: ‚ùå Rate limit –æ—Ç TikTok API: Too many connections started
INFO: üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –î–ª—è —Å–Ω—è—Ç–∏—è –ª–∏–º–∏—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ EulerStream API: https://www.eulerstream.com/pricing
```

### –ù–µ—Ç Username
```
WARNING: ‚ö†Ô∏è TikTok username –Ω–µ —É–∫–∞–∑–∞–Ω –¥–ª—è user_id=1
```

## –°—Ç–∞—Ç—É—Å
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ rate limit –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ WebSocket
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ UI
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ TikTok username
- ‚ùå –î–µ–º–æ —Ä–µ–∂–∏–º —É–¥–∞–ª–µ–Ω - —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

