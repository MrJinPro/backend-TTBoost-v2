# โ ะัะฟัะฐะฒะปะตะฝะธะต: ะกัะฐะฑะธะปัะฝัะต ัะทะตัะฝะตะนะผั ะดะปั ััะธะณะณะตัะพะฒ

## ะัะพะฑะปะตะผะฐ
ะกะพะฑััะธั ะพั TikTok ัะพะดะตัะถะฐั ะดะฒะฐ ะฟะพะปั ะดะปั ะธะผะตะฝะธ ะฟะพะปัะทะพะฒะฐัะตะปั:
- `nickname` - ะฟัะฑะปะธัะฝะพะต ะธะผั ั ัะผะพะดะทะธ (๐ง๐๐๐๐๐ ๐๐ข๐๐๐ข๐ก๐๐ง) - **ะะะกะขะะะะะฌะะะ**
- `unique_id` - ััะฐะฑะธะปัะฝัะน ะปะพะณะธะฝ (@oblivion_21o) - **ะกะขะะะะะฌะะะ**

ะกัะฐััะน ะบะพะด ะธัะฟะพะปัะทะพะฒะฐะป `nickname` ะฒ ะฟะตัะฒัั ะพัะตัะตะดั, ััะพ ะฟัะธะฒะพะดะธะปะพ ะบ:
- โ ะขัะธะณะณะตัั ะฝะต ััะฐะฑะฐััะฒะฐัั ะฟัะธ ัะผะตะฝะต ะฝะธะบะฝะตะนะผะฐ
- โ ะัะพะฑะปะตะผั ั Unicode/ัะผะพะดะทะธ ะฒ ััะฐะฒะฝะตะฝะธะธ ัััะพะบ
- โ ะะตะฟะพะฝััะฝะพ ะฟะพะปัะทะพะฒะฐัะตะปั ััะพ ะฟะธัะฐัั ะฒ ััะธะณะณะตั

## ะะตัะตะฝะธะต
ะะทะผะตะฝะตะฝ ะฟัะธะพัะธัะตั ะธะทะฒะปะตัะตะฝะธั username ะฒะพ ะะกะะฅ ะพะฑัะฐะฑะพััะธะบะฐั ัะพะฑััะธะน:

### ะะพ (ะะะะะะะะะฌะะ):
```python
username = event.user.nickname or event.user.unique_id
```

### ะะพัะปะต (ะะะะะะะฌะะ):
```python
username = event.user.unique_id or event.user.nickname
```

## ะะฐััะพะฝัััะต ัะฐะนะปั
- `backend/app/services/tiktok_service.py`:
  - โ CommentEvent (ัััะพะบะฐ ~251)
  - โ GiftEvent (ัััะพะบะฐ ~269)
  - โ LikeEvent (ัััะพะบะฐ ~322)
  - โ JoinEvent (ัััะพะบะฐ ~334)
  - โ FollowEvent (ัััะพะบะฐ ~345)
  - โ SubscribeEvent (ัััะพะบะฐ ~353)
  - โ ShareEvent (ัััะพะบะฐ ~365)

## ะงัะพ ะฝัะถะฝะพ ัะดะตะปะฐัั

### 1. ะะตัะตะทะฐะฟัััะธัั ะฑัะบะตะฝะด
```bash
# SSH ะฝะฐ ัะตัะฒะตั
cd /path/to/ttboost-backend
git pull origin main
systemctl restart ttboost
# ะธะปะธ
sudo supervisorctl restart ttboost
```

### 2. ะฃะดะฐะปะธัั ััะฐััะต ััะธะณะณะตัั
ะฃะดะฐะปะธัะต ะธะท ะฟัะธะปะพะถะตะฝะธั ะฒัะต ััะธะณะณะตัั, ะบะพัะพััะต ะธัะฟะพะปัะทััั:
- ะญะผะพะดะทะธ ะฒ username: โ "๐ง๐๐๐๐๐ ๐๐ข๐๐๐ข๐ก๐๐ง"
- Username ั ะทะฐะฟััะพะน ะฒ ะบะพะฝัะต: โ "oblivion_21o,"

### 3. ะกะพะทะดะฐัั ะฝะพะฒัะต ััะธะณะณะตัั
ะัะฟะพะปัะทัะนัะต ััะฐะฑะธะปัะฝัะน unique_id ะะะ ัะธะผะฒะพะปะฐ @:

#### ะัะธะผะตั: viewer_join ััะธะณะณะตั
- Event type: `viewer_join`
- Condition key: `username`
- Condition value: `oblivion_21o` โ (ะฑะตะท @, ะฑะตะท ัะผะพะดะทะธ)

#### ะัะธะผะตั: gift ััะธะณะณะตั
- Event type: `gift`
- Condition key: `gift_id`
- Condition value: `5655` โ (ัะธัะปะพะฒะพะน ID ะบะฐะบ ัััะพะบะฐ)

### 4. ะขะตััะธัะพะฒะฐะฝะธะต
1. ะัะฟัะฐะฒััะต ัะพะพะฑัะตะฝะธะต ะพั @oblivion_21o
2. ะัะพะฒะตัััะต ะปะพะณะธ - ะดะพะปะถะฝะพ ะฑััั:
   ```
   ๐ฏ ะะตัะฒะพะต ัะพะพะฑัะตะฝะธะต ะพั oblivion_21o - ะฟัะพะฒะตััะตะผ ััะธะณะณะตัั viewer_join
     Checking join trigger: key=username val='oblivion_21o' vs user='oblivion_21o'
     โ MATCHED! Sending viewer_join with sound
   ```
3. ะะฒัะบ ะดะพะปะถะตะฝ ะฒะพัะฟัะพะธะทะฒะตััะธัั

## ะคะพัะผะฐั username ะฒ ัะพะฑััะธัั
ะะพัะปะต ะพะฑะฝะพะฒะปะตะฝะธั ะฒัะต ัะพะฑััะธั ะฑัะดัั ัะพะดะตัะถะฐัั:
```json
{
  "event": "comment",
  "user": "oblivion_21o",  // โ stable unique_id
  "message": "ะฟัะธะฒะตั!"
}
```

ะะผะตััะพ ััะฐัะพะณะพ:
```json
{
  "event": "comment", 
  "user": "๐ง๐๐๐๐๐ ๐๐ข๐๐๐ข๐ก๐๐ง",  // โ unstable nickname
  "message": "ะฟัะธะฒะตั!"
}
```

## ะะฐะถะฝัะต ะทะฐะผะตัะฐะฝะธั
- โ ะัะฟะพะปัะทัะนัะต unique_id ะะะ ัะธะผะฒะพะปะฐ @
- โ ะัะฐะฒะธะปัะฝะพ: `oblivion_21o`
- โ ะะตะฟัะฐะฒะธะปัะฝะพ: `@oblivion_21o`
- โ ะะตะฟัะฐะฒะธะปัะฝะพ: `๐ง๐๐๐๐๐ ๐๐ข๐๐๐ข๐ก๐๐ง`

## ะกัะฐััั
- [x] ะะพะด ะพะฑะฝะพะฒะปะตะฝ (ะฒัะต 7 ะพะฑัะฐะฑะพััะธะบะพะฒ)
- [ ] ะัะบะตะฝะด ะฟะตัะตะทะฐะฟััะตะฝ ะฝะฐ ัะตัะฒะตัะต
- [ ] ะกัะฐััะต ััะธะณะณะตัั ัะดะฐะปะตะฝั
- [ ] ะะพะฒัะต ััะธะณะณะตัั ัะพะทะดะฐะฝั ั unique_id
- [ ] ะัะพัะตััะธัะพะฒะฐะฝะพ

---
ะะฐัะฐ ะธัะฟัะฐะฒะปะตะฝะธั: $(Get-Date -Format "yyyy-MM-dd HH:mm")
